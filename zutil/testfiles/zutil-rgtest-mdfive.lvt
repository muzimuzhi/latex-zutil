\input{zutil-regression-test}
\documentclass{minimal}

% \usepackage[presets=none]{zutil}

\ExplSyntaxOn

\debug_on:n { check-declarations , deprecation }

\START

\str_const:Nn \c_test_mdfive_expected_str
  { F58865412441AFD94CA155008AC0EC5B } % l3build 2025-12-19 --
  % { 70F2C13F7A03DEF4118CF5F646A7B768 } % l3build 2025-09-03

% moved out of \TEST to avoid a luatex-only log line created by \cctab_select:N
%    \g__cctab_tmpii_cctab=\catcodetable...
% where the "ii" in "tmpii" stands for the current group level
\file_get:nnN { regression-test.tex }
  { \cctab_select:N \c_document_cctab }
  \l_tmpa_tl
\str_const:Ne \c_test_mdfive_actual_str
  { \str_mdfive_hash:e { \exp_not:V \l_tmpa_tl } }

\TEST{Check~md5sum~of~regression-test.tex}{
  \str_if_eq:VVTF \c_test_mdfive_expected_str \c_test_mdfive_actual_str
    {
      \PASSED
    }
    {
      \iow_log:e
        {
          l3build~file~'regression-test.tex'~has~changed.~
          The~'zutil-regression-test.tex'~may~be~outdated.
          \iow_newline:
          Expected:~ \c_test_mdfive_expected_str \iow_newline:
          Actual:~ \use:n {~} ~ \c_test_mdfive_actual_str \iow_newline:
        }
    }
}

\END
